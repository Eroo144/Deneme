{% extends "base.html" %}

{% block content %}
<div class="container-fluid vh-100">
    <div class="row h-100">
        <!-- Sol: G√∂nderi Payla≈üma Kartƒ± -->
        <div class="col-md-3 h-100 d-flex flex-column" style="padding-right: 30px; position: sticky; top: 0;">
            <h3>G√∂nderi Payla≈ü</h3>
            <form method="POST" enctype="multipart/form-data" class="mb-4">
                <textarea name="content" rows="3" placeholder="Bir ≈üeyler yaz..." class="form-control mb-2" required></textarea><br>
                
                <!-- Fotoƒüraf Y√ºkleme Alanƒ± -->
                <input type="file" name="image" accept="image/*" class="form-control mb-2">
                
                <button type="submit" class="btn btn-primary w-100">Payla≈ü</button>
            </form>
        </div>

        <!-- Ortada: G√∂nderi Akƒ±≈üƒ± -->
        <div class="col-md-6 h-100" style="overflow-y: auto; padding: 0 15px;">
            <h3>G√∂nderiler</h3>
            <div class="posts-list">
                {% for post in posts %}
                    <div style="border: 1px solid #ccc; padding: 20px; margin-bottom: 20px; border-radius: 10px; background-color: #f9f9f9; color: #333; box-shadow: 0px 2px 8px rgba(0,0,0,0.1);">
                        <strong style="color: #007bff; font-size: 1.2em;">{{ post.author.username }}</strong><br>
                        <small style="font-size: 0.9em; color: #777;">{{ post.timestamp.strftime("%d.%m.%Y %H:%M") }}</small>
                        <p style="font-size: 1.2em; color: #444;">{{ post.body }}</p>
                        
                        <!-- Fotoƒüraf Y√ºklenmi≈üse G√∂r√ºnt√ºle -->
                        {% if post.image %}
                            <div class="mt-2" style="max-width: 100%; overflow: auto;">
                                <img src="{{ url_for('static', filename='post_images/' + post.image) }}" alt="Post image" class="img-fluid" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);">
                            </div>
                        {% endif %}
                        
                        <!-- BEƒûENƒ∞ ve YORUM B√ñL√úM√ú -->
                        <div class="mt-3">
                            <!-- Beƒüeni butonu -->
                            <form action="{{ url_for('like_post', post_id=post.id) }}" method="POST" style="display: inline;">
                                <button type="submit" class="btn btn-sm {% if post.is_liked_by(current_user) %}btn-danger{% else %}btn-outline-danger{% endif %} me-2">
                                    ‚ù§Ô∏è Beƒüen ({{ post.liked_by|length }})
                                </button>
                            </form>
                            
                            <!-- Yorum sayƒ±sƒ± -->
                            <span class="text-muted">üí¨ Yorumlar ({{ post.post_comments|length }})</span>
                        </div>
                        
                        <!-- YORUM YAPMA FORMU -->
                        <div class="mt-3">
                            <form action="{{ url_for('comment_post', post_id=post.id) }}" method="POST">
                                <div class="input-group">
                                    <input type="text" name="comment" class="form-control" placeholder="Yorum yaz..." required>
                                    <button type="submit" class="btn btn-primary">G√∂nder</button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- YORUMLARI G√ñSTER -->
                        {% if post.post_comments %}
                            <div class="mt-3" style="border-top: 1px solid #eee; padding-top: 10px;">
                                <h6>Yorumlar:</h6>
                                {% for comment in post.post_comments %}
                                    <div class="mb-2 p-2" style="background-color: #f0f0f0; border-radius: 5px;">
                                        <strong>{{ comment.user.username }}</strong>: 
                                        {{ comment.body }}
                                        <br>
                                        <small class="text-muted">{{ comment.timestamp.strftime("%d.%m.%Y %H:%M") }}</small>
                                    </div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                {% else %}
                    <p>Hen√ºz g√∂nderi yok.</p>
                {% endfor %}
            </div>
        </div>

        <!-- Saƒü: Bilgilendirme Kartƒ± -->
        <div class="col-md-3 h-100" style="padding-left: 30px; position: sticky; top: 0;">
            <h3>Bilgilendirme</h3>
            <div style="border: 1px solid #ccc; padding: 20px; border-radius: 10px; background-color: #f1f1f1; box-shadow: 0px 2px 8px rgba(0,0,0,0.1);">
                <p style="color: #333; font-size: 1.1em;">Bu alanda kullanƒ±cƒ±lar i√ßin √ße≈üitli bilgilendirmeler yapƒ±labilir. √ñrneƒüin, hesap ayarlarƒ±, duyurular veya yeni gelen √∂zellikler hakkƒ±nda bilgiler verilebilir.</p>
            </div>
        </div>
    </div>
</div>

<style>
    .container-fluid.vh-100 {
        height: 100vh;
        max-width: 100%;
    }
    
    .row.h-100 {
        height: 100%;
    }
    
    .col-md-3.h-100 {
        height: 100%;
    }
    
    .col-md-6.h-100 {
        height: 100%;
        max-height: 100vh;
    }
</style>
{% endblock %}